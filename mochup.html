<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Mockup Creator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f0f2f5;
      --card: #fff;
      --text: #333;
      --accent: #4A90E2;
      --shadow: rgba(0,0,0,0.1);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 20px;
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex; justify-content: center;
    }
    .container {
      background: var(--card);
      border-radius: 12px;
      box-shadow: 0 6px 18px var(--shadow);
      width: 100%; max-width: 700px;
      padding: 32px;
    }
    h1 { text-align: center; margin-bottom: 24px; font-size: 2rem; }
    label { display: block; font-weight: 500; margin: 16px 0 8px; }
    input[type="file"], select {
      width: 100%; padding: 10px; border: 1px solid #ccc;
      border-radius: 8px; background: #fafafa;
    }
    .controls { margin: 32px 0; display: grid; gap: 20px; }
    .control-group { display: flex; flex-direction: column; }
    .slider-wrapper { display: flex; align-items: center; gap: 8px; }
    input[type="range"] { flex: 1; height: 6px; border-radius: 4px; accent-color: var(--accent); }
    .arrow-btn { width:32px; height:32px; border:none; border-radius:50%; background:#eee; color:var(--accent); cursor:pointer; }
    .arrow-btn:hover { background: var(--accent); color: #fff; transform: scale(1.1); }
    .thumbnail-container { display:flex; flex-wrap:wrap; gap:12px; justify-content:center; margin:16px 0; }
    .thumbnail-container img { width:80px; height:80px; object-fit:cover; border-radius:8px; cursor:pointer; border:2px solid transparent; box-shadow: 0 4px 12px var(--shadow); }
    .thumbnail-container img.selected { border-color:var(--accent); }
    .no-mockups { text-align:center; color:#777; margin:16px 0; }
    canvas { width:100%; height:auto; margin:32px 0; border-radius:8px; box-shadow: 0 6px 18px var(--shadow); }
    #download-btn { width:100%; padding:14px; background:var(--accent); color:#fff; border:none; border-radius:8px; font-size:1rem; cursor:pointer; box-shadow: 0 4px 12px var(--shadow); }
    #download-btn:hover { transform: translateY(-2px) scale(1.02); box-shadow: 0 8px 24px var(--shadow); }
  </style>
</head>
<body>
  <div class="container">
    <h1>Mockup Creator</h1>

    <label for="add-mockup-input">Upload a mockup (JPG/PNG)</label>
    <input type="file" id="add-mockup-input" accept="image/*">
    <div id="mockup-thumbnails" class="thumbnail-container"></div>
    <div id="no-mockups-msg" class="no-mockups">No mockups yet — upload one above.</div>

    <label for="design-input">Select your design (PNG)</label>
    <input type="file" id="design-input" accept="image/png">

    <div class="controls">
      <div class="control-group">
        <label for="scale-range">Scale: <span id="scale-val">1.00</span></label>
        <div class="slider-wrapper">
          <button class="arrow-btn" data-target="scale-range" data-step="-0.01">←</button>
          <input type="range" id="scale-range" min="0.1" max="2" step="0.01" value="1.0">
          <button class="arrow-btn" data-target="scale-range" data-step="0.01">→</button>
        </div>
      </div>
      <div class="control-group">
        <label for="offset-x-range">X Offset: <span id="offset-x-val">0</span>%</label>
        <div class="slider-wrapper">
          <button class="arrow-btn" data-target="offset-x-range" data-step="-1">←</button>
          <input type="range" id="offset-x-range" min="-50" max="50" step="1" value="0">
          <button class="arrow-btn" data-target="offset-x-range" data-step="1">→</button>
        </div>
      </div>
      <div class="control-group">
        <label for="offset-y-range">Y Offset: <span id="offset-y-val">0</span>%</label>
        <div class="slider-wrapper">
          <button class="arrow-btn" data-target="offset-y-range" data-step="-1">←</button>
          <input type="range" id="offset-y-range" min="-50" max="50" step="1" value="0">
          <button class="arrow-btn" data-target="offset-y-range" data-step="1">→</button>
        </div>
      </div>
      <div class="control-group">
        <label for="resolution-select">Export Resolution</label>
        <select id="resolution-select">
          <option value="1">1× (Original)</option>
          <option value="2" selected>2× (Retina)</option>
          <option value="3">3×</option>
          <option value="4">4×</option>
        </select>
      </div>
    </div>

    <canvas id="mockup-canvas"></canvas>
    <button id="download-btn">Download Mockup</button>
  </div>

  <script>
    const canvas = document.getElementById('mockup-canvas'), ctx = canvas.getContext('2d');
    let mockupImages = {}, selectedMockup = null, designImg = null, pressTimer = null;
    const addMockupInput = document.getElementById('add-mockup-input'), thumbnails = document.getElementById('mockup-thumbnails'), noMsg = document.getElementById('no-mockups-msg'), designInput = document.getElementById('design-input'), scaleRange = document.getElementById('scale-range'), offsetXRange = document.getElementById('offset-x-range'), offsetYRange = document.getElementById('offset-y-range'), resolutionSelect = document.getElementById('resolution-select'), scaleVal = document.getElementById('scale-val'), offsetXVal = document.getElementById('offset-x-val'), offsetYVal = document.getElementById('offset-y-val');
    function loadStoredMockups() {
      const stored = JSON.parse(localStorage.getItem('mockupImages') || '{}');
      mockupImages = stored;
      localStorage.setItem('mockupImages', JSON.stringify(stored));
    }
    function renderThumbnails() {
      thumbnails.innerHTML = '';
      const keys = Object.keys(mockupImages);
      if (!keys.length) { noMsg.style.display = 'block'; return; }
      noMsg.style.display = 'none';
      keys.forEach(label => {
        const img = document.createElement('img'); img.src = mockupImages[label]; img.alt = label;
        img.onclick = () => selectMockup(label, img);
        img.addEventListener('mousedown', startPress(label)); img.addEventListener('touchstart', startPress(label));
        img.addEventListener('mouseup', cancelPress); img.addEventListener('mouseleave', cancelPress); img.addEventListener('touchend', cancelPress);
        thumbnails.appendChild(img);
      });
      if (!selectedMockup && keys.length) thumbnails.firstChild.click();
    }
    function startPress(label) { return () => { pressTimer = setTimeout(() => removeMockup(label), 800); }; }
    function cancelPress() { clearTimeout(pressTimer); }
    function selectMockup(label, imgEl) {
      thumbnails.querySelectorAll('img').forEach(i => i.classList.remove('selected')); imgEl.classList.add('selected');
      selectedMockup = label; localStorage.setItem('selectedMockup', label); loadMockup(label);
    }
    function removeMockup(label) { if (!confirm(`Remove ${label}?`)) return; delete mockupImages[label]; localStorage.setItem('mockupImages', JSON.stringify(mockupImages)); if (selectedMockup === label) { localStorage.removeItem('selectedMockup'); selectedMockup = null; } renderThumbnails(); }
    function loadMockup(label) {
      const bg = new Image(); bg.onload = () => { canvas.width = bg.width; canvas.height = bg.height; drawCanvas(); };
      bg.src = mockupImages[label]; window.bgImg = bg;
    }
    function drawCanvas() { if (!window.bgImg) return; ctx.clearRect(0, 0, canvas.width, canvas.height); ctx.drawImage(window.bgImg, 0, 0); if (designImg) { const s = parseFloat(scaleRange.value), w = designImg.width * s, h = designImg.height * s, xOff = parseInt(offsetXRange.value) / 100 * canvas.width, yOff = parseInt(offsetYRange.value) / 100 * canvas.height, x = (canvas.width - w) / 2 + xOff, y = (canvas.height - h) / 2 + yOff; ctx.drawImage(designImg, x, y, w, h); } }
    function updateLabels() { scaleVal.textContent = parseFloat(scaleRange.value).toFixed(2); offsetXVal.textContent = offsetXRange.value; offsetYVal.textContent = offsetYRange.value; }
    addMockupInput.onchange = e => { const f = e.target.files[0]; if (!f) return; const r = new FileReader(); r.onload = () => { mockupImages[f.name] = r.result; localStorage.setItem('mockupImages', JSON.stringify(mockupImages)); localStorage.setItem('selectedMockup', f.name); selectedMockup = f.name; renderThumbnails(); }; r.readAsDataURL(f); };
    designInput.onchange = e => { const f = e.target.files[0]; if (!f) return; designImg = new Image(); designImg.onload = () => { updateLabels(); drawCanvas(); }; designImg.src = URL.createObjectURL(f); };
    Array.from(document.querySelectorAll('.arrow-btn')).forEach(btn => { btn.onclick = () => { const s = document.getElementById(btn.dataset.target), step = parseFloat(btn.dataset.step), v = Math.min(Math.max(parseFloat(s.value) + step, parseFloat(s.min)), parseFloat(s.max)); s.value = v.toFixed(s.step.split('.')[1]?.length || 0); s.dispatchEvent(new Event('input')); }; });
    [scaleRange, offsetXRange, offsetYRange].forEach(slider => { slider.oninput = () => { updateLabels(); drawCanvas(); }; });
    document.getElementById('download-btn').onclick = () => { const m = parseInt(resolutionSelect.value, 10), ex = document.createElement('canvas'), exCtx = ex.getContext('2d'); ex.width = canvas.width * m; ex.height = canvas.height * m; exCtx.scale(m, m); exCtx.drawImage(window.bgImg, 0, 0); if (designImg) { const s = parseFloat(scaleRange.value), w = designImg.width * s, h = designImg.height * s, xOff = parseInt(offsetXRange.value) / 100 * canvas.width, yOff = parseInt(offsetYRange.value) / 100 * canvas.height, x = (canvas.width - w) / 2 + xOff, y = (canvas.height - h) / 2 + yOff; exCtx.drawImage(designImg, x, y, w, h); } ex.toBlob(blob => { const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `tshirt-mockup@${m}x.png`; a.click(); URL.revokeObjectURL(a.href); }, 'image/png'); };
    (function() { loadStoredMockups(); renderThumbnails(); updateLabels(); })();
  </script>
</body>
</html>
