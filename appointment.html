<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Advanced Mega Millions Generator</title>
  <style>
    /* ---------- Reset & Font ---------- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Arial, sans-serif; background: #f5f5f5; color: #333; }
    .container { 
      max-width: 800px; margin: 40px auto; padding: 20px; 
      background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 { text-align: center; margin-bottom: 20px; font-size: 1.8em; }
    button {
      display: block; margin: 0 auto; padding: 10px 20px; 
      font-size: 1em; border: none; border-radius: 4px; 
      background: #666; color: #fff; cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    button:active { transform: translateY(1px); }
    .numbers { display: flex; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
    .ball {
      width: 60px; height: 60px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      margin: 8px; font-size: 1.2em; font-weight: bold;
      border: 2px solid #ccc; user-select: none;
    }
    .white { background: #fff; color: #333; }
    .mega  { background: #ffd700; color: #333; border-color: #e6c200; }
    .info { margin-top: 30px; font-size: 0.9em; line-height: 1.4; }
    .info h2 { font-size: 1.2em; margin-bottom: 8px; }
    .info ul { margin-left: 20px; margin-bottom: 12px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Advanced Mega Millions Generator</h1>
    <button id="generateBtn">Generate Numbers</button>
    <div id="numbers" class="numbers"></div>
    <div id="info" class="info"></div>
  </div>

  <script>
    // —— 1) Precomputed weights for current game (post-Oct 2017) ——
    // whiteProbs[1] is weight for ball “1”, … whiteProbs[70] for “70”
    const whiteProbs = [
      0,
      0.014787,0.013809,0.018619,0.014272,0.013818,0.014839,0.013410,0.016842,0.013278,0.020060,
      0.013514,0.015455,0.013818,0.018793,0.014569,0.018589,0.017687,0.015946,0.017587,0.016105,
      0.020112,0.015987,0.020410,0.020683,0.014924,0.013790,0.019604,0.017940,0.013579,0.019284,
      0.018731,0.016502,0.018849,0.015321,0.011907,0.013045,0.011367,0.013788,0.015092,0.016345,
      0.016512,0.015073,0.016981,0.015843,0.015514,0.015966,0.012983,0.017224,0.014399,0.014132,
      0.014782,0.017532,0.015670,0.013551,0.016911,0.017042,0.016734,0.014214,0.014862,0.017103,
      0.016238,0.015784,0.012456,0.011321,0.013754,0.013962,0.014830,0.015201,0.014039,0.015892,
      0.014610,0.012983,0.015847
    ];

    // megaProbs[1]…megaProbs[25]
    const megaProbs = [
      0,
      0.048898,0.041254,0.044475,0.037696,0.020903,
      0.036731,0.036940,0.033978,0.037983,0.037304,
      0.029005,0.033622,0.036755,0.032109,0.045812,
      0.033242,0.033817,0.031297,0.035664,0.040122,
      0.028884,0.027602,0.031280,0.025865,0.022951
    ];

    // —— 2) Summary of patterns ——
    const summary = {
      maxDate: '2025-04-22',
      meanSum: 173.67,
      stdSum: 44.64,
      within1StdPct: 67.73,
      topWhites: [
        {num:10,prob:0.02006},
        {num:17,prob:0.01879},
        {num:3,prob:0.01862},
        {num:31,prob:0.01859},
        {num:15,prob:0.01769}
      ],
      topPairs: [[10,17],[10,20],[39,42],[2,31],[15,32]],
      topTriplets: [[30,35,66],[6,37,46],[10,38,43],[14,48,58],[23,24,43]],
      oddDist: {0:3.33,1:16.13,2:33.16,3:30.99,4:14.08,5:2.30},
      highDist: {0:3.71,1:16.26,2:33.42,3:30.99,4:13.96,5:1.66}
    };

    // —— 3) Weighted sampling helpers ——
    function weightedSample(probs) {
      const total = probs.reduce((sum,v)=> sum+v,0);
      let r = Math.random()*total, cum=0;
      for (let i=0; i<probs.length; i++){
        cum += probs[i];
        if (r < cum) return i;
      }
      return probs.length-1;
    }

    function weightedSampleWithoutReplacement(probs, count) {
      // Build an index→weight map
      let items = [];
      for (let i=1; i<probs.length; i++){
        items.push({i, w: probs[i]});
      }
      const pick = [];
      for (let k=0; k<count; k++){
        const tot = items.reduce((s,x)=>s+x.w,0);
        let r = Math.random()*tot, c=0;
        for (let j=0; j<items.length; j++){
          c += items[j].w;
          if (r < c) {
            pick.push(items[j].i);
            items.splice(j,1);
            break;
          }
        }
      }
      return pick;
    }

    // —— 4) Generate & display —— 
    function generateNumbers() {
      const btn = document.getElementById('generateBtn');
      btn.textContent = 'Generating…';
      // Whites
      let whites = weightedSampleWithoutReplacement(whiteProbs,5);
      whites.sort((a,b)=>a-b);
      // Mega
      let mega = weightedSample(megaProbs);

      // Render balls
      const container = document.getElementById('numbers');
      container.innerHTML = '';
      whites.forEach(n => {
        const d = document.createElement('div');
        d.className = 'ball white';
        d.textContent = n;
        container.appendChild(d);
      });
      const m = document.createElement('div');
      m.className = 'ball mega';
      m.textContent = mega;
      container.appendChild(m);

      // Render summary info
      renderInfo();

      btn.textContent = 'Generate Numbers';
    }

    function renderInfo() {
      const info = document.getElementById('info');
      info.innerHTML = `
        <h2>Patterns & Statistics</h2>
        <p><strong>Data through:</strong> ${summary.maxDate}</p>
        <p><strong>White‐ball sum mean ±σ:</strong> ${summary.meanSum} ± ${summary.stdSum}
           (${summary.within1StdPct}% of draws)</p>
        <ul>
          <li><strong>Top 5 weighted whites:</strong>
            ${summary.topWhites.map(w=>w.num+' ('+((w.prob*100).toFixed(2))+'%)').join(', ')}
          </li>
          <li><strong>Top 5 pairs:</strong> 
            ${summary.topPairs.map(p=>'['+p.join(',')+']').join(', ')}
          </li>
          <li><strong>Top 5 triplets:</strong> 
            ${summary.topTriplets.map(t=>'['+t.join(',')+']').join(', ')}
          </li>
        </ul>
        <p><strong>Odd/Even distribution (whites):</strong></p>
        <ul>
          ${Object.entries(summary.oddDist).map(
            ([odd, pct])=>`<li>${odd} odd & ${5-odd} even → ${pct}%</li>`
          ).join('')}
        </ul>
        <p><strong>High/Low distribution (whites: >35 high):</strong></p>
        <ul>
          ${Object.entries(summary.highDist).map(
            ([high, pct])=>`<li>${high} high & ${5-high} low → ${pct}%</li>`
          ).join('')}
        </ul>
        <p style="font-size:0.8em; color:#555;">
          <em>Algorithm:</em> Each ball’s weight = historical frequency × exp(–daysSinceLastDraw/365); then sampled without replacement.  
          <em>No guarantee—just data‐driven guidance.</em>
        </p>
      `;
    }

    document.getElementById('generateBtn')
            .addEventListener('click', generateNumbers);
  </script>
</body>
</html>
